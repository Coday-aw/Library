## Library Project

## Features
- Book Management: Add, Update, and Delete books from the catalog.
- Register Loans: Check out books with automatic validation.
- Double-Loan Prevention: Logic to ensure a book cannot be borrowed if it is not in stock.
- Existence Validation: Validates that both the Member and Book exist before creating a loan.

## Database Optimization
- Stored Procedures: All core logic is handled on the database level for security and speed.
- SQL Indexing: Indexed BookTitle for fast searching.
- Indexed FkMemberId for quick loan history retrieval.

## Tech Stack
- Language: C# (.NET 8.0)
- Database: SQL Server
- ORM: Entity Framework Core

## How to Run
- Open SQL Server Management Studio (SSMS).
- Run the provided database schema script to create the Book, Member, BookAuthor, and BookLoan tables.
- Execute the Stored Procedures (DeleteBook, RegisterLoan, etc.) found in the /SQL folder of this project.

## Entity Relationship Diagram
<img width="3399" height="2496" alt="erdplus (11)" src="https://github.com/user-attachments/assets/c53bf507-2763-40e8-9535-6f23c32c3869" />

## Index Scan plan
<ShowPlanXML xmlns="http://schemas.microsoft.com/sqlserver/2004/07/showplan" Version="1.557" Build="15.0.2000.1574"><BatchSequence><Batch><Statements><StmtSimple StatementText="SELECT * FROM Book WHERE BookTitle LIKE &apos;The great%&apos;" StatementId="1" StatementCompId="1" StatementType="SELECT" RetrievedFromCache="true" StatementSubTreeCost="0.0033425" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="TRIVIAL" QueryHash="0x1BB816E3D27E895C" QueryPlanHash="0x83022BEB599C1A8B" CardinalityEstimationModelVersion="150"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan DegreeOfParallelism="1" CachedPlanSize="24" CompileTime="8" CompileCPU="8" CompileMemory="136"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="160512" EstimatedPagesCached="40128" EstimatedAvailableDegreeOfParallelism="2" MaxCompileMemory="3898552"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2025-12-24T12:32:24.17" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000002_37A5467C]" Table="[Book]" Schema="[dbo]" Database="[LibraryDB]"></StatisticsInfo></OptimizerStatsUsage><TraceFlags IsCompileTime="1"><TraceFlag Value="822" Scope="Global"></TraceFlag><TraceFlag Value="833" Scope="Global"></TraceFlag><TraceFlag Value="835" Scope="Global"></TraceFlag><TraceFlag Value="851" Scope="Global"></TraceFlag><TraceFlag Value="3425" Scope="Global"></TraceFlag><TraceFlag Value="5504" Scope="Global"></TraceFlag><TraceFlag Value="8052" Scope="Global"></TraceFlag><TraceFlag Value="8076" Scope="Global"></TraceFlag><TraceFlag Value="8904" Scope="Global"></TraceFlag><TraceFlag Value="9038" Scope="Global"></TraceFlag></TraceFlags><TraceFlags IsCompileTime="0"><TraceFlag Value="822" Scope="Global"></TraceFlag><TraceFlag Value="833" Scope="Global"></TraceFlag><TraceFlag Value="835" Scope="Global"></TraceFlag><TraceFlag Value="851" Scope="Global"></TraceFlag><TraceFlag Value="3425" Scope="Global"></TraceFlag><TraceFlag Value="5504" Scope="Global"></TraceFlag><TraceFlag Value="8052" Scope="Global"></TraceFlag><TraceFlag Value="8076" Scope="Global"></TraceFlag><TraceFlag Value="8904" Scope="Global"></TraceFlag><TraceFlag Value="9038" Scope="Global"></TraceFlag></TraceFlags><QueryTimeStats ElapsedTime="0" CpuTime="0"></QueryTimeStats><RelOp NodeId="0" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="1" EstimatedRowsRead="55" EstimateIO="0.003125" EstimateCPU="0.0002175" AvgRowSize="225" EstimatedTotalSubtreeCost="0.0033425" TableCardinality="55" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookId"></ColumnReference><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="Genre"></ColumnReference><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="PublicationYear"></ColumnReference><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="StockBalance"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="0" ActualRows="1" Batches="0" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="3" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="55" ActualEndOfScans="1" ActualExecutions="1" ActualExecutionMode="Row"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookId"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="Genre"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="PublicationYear"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="StockBalance"></ColumnReference></DefinedValue></DefinedValues><Object Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Index="[PK__Book__3DE0C2077258816A]" IndexKind="Clustered" Storage="RowStore"></Object><Predicate><ScalarOperator ScalarString="[LibraryDB].[dbo].[Book].[BookTitle] like N&apos;The great%&apos;"><Intrinsic FunctionName="like"><ScalarOperator><Identifier><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="N&apos;The great%&apos;"></Const></ScalarOperator></Intrinsic></ScalarOperator></Predicate></IndexScan></RelOp></QueryPlan></StmtSimple></Statements></Batch></BatchSequence></ShowPlanXML>

## Index Seek plan
<ShowPlanXML xmlns="http://schemas.microsoft.com/sqlserver/2004/07/showplan" Version="1.557" Build="15.0.2000.1574"><BatchSequence><Batch><Statements><StmtSimple StatementText="SELECT BookTitle FROM Book WHERE BookTitle LIKE &apos;The great%&apos;" StatementId="1" StatementCompId="1" StatementType="SELECT" RetrievedFromCache="true" StatementSubTreeCost="0.0032831" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="TRIVIAL" QueryHash="0x042824EB1484648F" QueryPlanHash="0x2106C25DC7FC7C45" CardinalityEstimationModelVersion="150"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan DegreeOfParallelism="1" CachedPlanSize="24" CompileTime="9" CompileCPU="9" CompileMemory="136"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="160512" EstimatedPagesCached="40128" EstimatedAvailableDegreeOfParallelism="2" MaxCompileMemory="3896752"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2025-12-24T12:32:24.17" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000002_37A5467C]" Table="[Book]" Schema="[dbo]" Database="[LibraryDB]"></StatisticsInfo></OptimizerStatsUsage><TraceFlags IsCompileTime="1"><TraceFlag Value="822" Scope="Global"></TraceFlag><TraceFlag Value="833" Scope="Global"></TraceFlag><TraceFlag Value="835" Scope="Global"></TraceFlag><TraceFlag Value="851" Scope="Global"></TraceFlag><TraceFlag Value="3425" Scope="Global"></TraceFlag><TraceFlag Value="5504" Scope="Global"></TraceFlag><TraceFlag Value="8052" Scope="Global"></TraceFlag><TraceFlag Value="8076" Scope="Global"></TraceFlag><TraceFlag Value="8904" Scope="Global"></TraceFlag><TraceFlag Value="9038" Scope="Global"></TraceFlag></TraceFlags><TraceFlags IsCompileTime="0"><TraceFlag Value="822" Scope="Global"></TraceFlag><TraceFlag Value="833" Scope="Global"></TraceFlag><TraceFlag Value="835" Scope="Global"></TraceFlag><TraceFlag Value="851" Scope="Global"></TraceFlag><TraceFlag Value="3425" Scope="Global"></TraceFlag><TraceFlag Value="5504" Scope="Global"></TraceFlag><TraceFlag Value="8052" Scope="Global"></TraceFlag><TraceFlag Value="8076" Scope="Global"></TraceFlag><TraceFlag Value="8904" Scope="Global"></TraceFlag><TraceFlag Value="9038" Scope="Global"></TraceFlag></TraceFlags><QueryTimeStats ElapsedTime="0" CpuTime="0"></QueryTimeStats><RelOp NodeId="0" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="111" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="55" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></OutputList><RunTimeInformation><RunTimeCountersPerThread Thread="0" ActualRows="1" Batches="0" ActualElapsedms="0" ActualCPUms="0" ActualScans="1" ActualLogicalReads="2" ActualPhysicalReads="0" ActualReadAheads="0" ActualLobLogicalReads="0" ActualLobPhysicalReads="0" ActualLobReadAheads="0" ActualRowsRead="1" ActualEndOfScans="1" ActualExecutions="1" ActualExecutionMode="Row"></RunTimeCountersPerThread></RunTimeInformation><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></DefinedValue></DefinedValues><Object Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Index="[IX_Book_Title]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><StartRange ScanType="GE"><RangeColumns><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;The great&apos;"><Const ConstValue="N&apos;The great&apos;"></Const></ScalarOperator></RangeExpressions></StartRange><EndRange ScanType="LT"><RangeColumns><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;The greaU&apos;"><Const ConstValue="N&apos;The greaU&apos;"></Const></ScalarOperator></RangeExpressions></EndRange></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="[LibraryDB].[dbo].[Book].[BookTitle] like N&apos;The great%&apos;"><Intrinsic FunctionName="like"><ScalarOperator><Identifier><ColumnReference Database="[LibraryDB]" Schema="[dbo]" Table="[Book]" Column="BookTitle"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="N&apos;The great%&apos;"></Const></ScalarOperator></Intrinsic></ScalarOperator></Predicate></IndexScan></RelOp></QueryPlan></StmtSimple></Statements></Batch></BatchSequence></ShowPlanXML>
